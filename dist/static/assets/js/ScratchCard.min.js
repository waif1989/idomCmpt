!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("IncrementalDOM"),require("IdomBase")):"function"==typeof define&&define.amd?define(["IncrementalDOM","IdomBase"],e):"object"==typeof exports?exports.ScratchCard=e(require("IncrementalDOM"),require("IdomBase")):t.ScratchCard=e(t.IncrementalDOM,t.IdomBase)}(window,function(t,e){return function(t){function e(e){for(var r,o,s=e[0],c=e[1],l=e[2],h=0,d=[];h<s.length;h++)o=s[h],a[o]&&d.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);for(u&&u(e);d.length;)d.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(r=!1)}r&&(i.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},a={5:0},i=[];function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="./";var s=window.webpackJsonp_name_=window.webpackJsonp_name_||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;return i.push([104,0]),n()}({0:function(e,n){e.exports=t},1:function(t,n){t.exports=e},104:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n(2),i=n.n(a),o=n(3),s=n.n(o),c=n(4),l=n.n(c),u=n(5),h=n.n(u),d=n(6),p=n.n(d),f=(n(105),n(1)),v=n.n(f),m=Object.prototype.hasOwnProperty,y=["class","scr-card-text"],b=["class","scr-card-container"],g=function(t){function e(t,n){s()(this,e);var r=h()(this,(e.__proto__||i()(e)).call(this,t,n));return r.state={height:0},r.id="scratchcard-"+(1e4*Math.random()).toFixed(0),r.myCanvas=null,r}return p()(e,t),l()(e,[{key:"createCanvas",value:function(){var t=document.getElementById(this.props.id?this.props.id:this.id),e=t.getBoundingClientRect().width,n=t.getBoundingClientRect().height;this.setState({height:n}),t.setAttribute("width",e+"px"),t.setAttribute("height",n+"px"),t.setAttribute("style","position:absolute;z-index:2;");var r=t.getContext("2d");if(/^#\w{6}$|^#\w{3}$/i.test(this.props.cardMask))return r.beginPath(),r.fillStyle=this.props.cardMask,r.rect(0,0,e,n),r.closePath(),r.fill(),t;var a=new Image;return a.crossOrigin="Anonymous",a.src=this.props.cardMask||"https://res.126.net/cross/img/component/scratch-card/mask-default.png",a.onload=function(){r.drawImage(a,0,0,a.width,a.height,0,0,t.width,t.height)},t}},{key:"scratchFn",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};if(t.playState&&t.myCanvasObject){t.autoShowPercent||0===t.autoShowPercent||(t.autoShowPercent=70),t.timeOut||0===t.timeOut||(t.timeOut=3e3);var r="ontouchstart"in window,a=r?"touchstart":"mousedown",i=r?"touchmove":"mousemove",o=r?"touchend":"mouseup",s=t.myCanvasObject.getContext("2d"),c=null,l=!1,u=[],h=0,d=0;document.body.addEventListener("touchmove",function(t){t.cancelable&&(l?t.preventDefault():t.stopPropagation())},{passive:!1}),t.myCanvasObject.addEventListener(a,function(e){var a=window.event||e;t.myCanvasObject.style.cursor="move";var i=t.myCanvasObject.getBoundingClientRect().x,o=t.myCanvasObject.getBoundingClientRect().y;l=!0,h=r?a.targetTouches[0].clientX-i:a.clientX-i,d=r?a.targetTouches[0].clientY-o:a.clientY-o,u.push([h,d]),t.playState?p():n()}),t.myCanvasObject.addEventListener(i,function(e){if(t.playState){var n=window.event||e,a=t.myCanvasObject.getBoundingClientRect().x,i=t.myCanvasObject.getBoundingClientRect().y;l&&(h=r?n.targetTouches[0].clientX-a:n.clientX-a,d=r?n.targetTouches[0].clientY-i:n.clientY-i,u.push([h,d]),p())}else{var o=0,s=t.timeOut/100;c=setInterval(function(){t.playState&&o<s?window.clearInterval(c):!t.playState&&o<s?++o:o>s&&window.clearInterval(c)},100)}}),t.myCanvasObject.addEventListener(o,function(n){l=!1,u=[];for(var r=s.getImageData(0,0,t.myCanvasObject.width,t.myCanvasObject.height).data,a=r.length/4,i=0,o=3;o<r.length;o+=4)i+=r[o]?0:1;i/a*100>=t.autoShowPercent&&(s.clearRect(0,0,t.myCanvasObject.width,t.myCanvasObject.height),e())})}function p(){if(s.save(),s.beginPath(),s.moveTo(u[0][0],u[0][1]),s.lineCap="round",s.lineJoin="round",s.lineWidth=t.scratchWidth,s.globalCompositeOperation="destination-out",1===u.length)s.lineTo(u[0][0]+1,u[0][1]+1);else for(var e=1;e<u.length;e++)s.lineTo(u[e][0],u[e][1]),s.moveTo(u[e][0],u[e][1]);s.closePath(),s.stroke(),s.restore()}}},{key:"shouldUpdate",value:function(t){return this.scratchFn({myCanvasObject:this.myCanvas,scratchWidth:t.scratchWidth,playState:t.playState,autoShowPercent:t.autoShowPercent}),!0}},{key:"didMounted",value:function(){this.myCanvas=this.createCanvas(),this.scratchFn({myCanvasObject:this.myCanvas,scratchWidth:this.props.scratchWidth,playState:this.props.playState,autoShowPercent:this.props.autoShowPercent},this.props.sucCb,this.props.failCb)}},{key:"render",value:function(){var t=this;return Object(r.elementOpen)("div","uuid-21",b,"style","height: "+t.state.height+"px"),Object(r.elementOpen)("canvas",null,null,"id",this.props.id?this.props.id:this.id),Object(r.elementClose)("canvas"),Object(r.elementOpen)("div","uuid-20",y,"style",this.props.prizeStyle),function t(e){var n=typeof e;if("number"===n||"string"===n||"object"===n&&e instanceof String)Object(r.text)(e);else if(Array.isArray(e))for(var a=0;a<e.length;a++)t(e[a]);else if("object"===n)if(e.__jsxDOMWrapper){var i=e.func,o=e.args;o?i.apply(this,o):i()}else if("[object Object]"===String(e))for(var s in e)m.call(e,a)&&t(e[a])}(this.props.prizeNames||""),Object(r.elementClose)("div"),Object(r.elementClose)("div")}}]),e}(v.a);e.default=g},105:function(t,e,n){var r=n(106);"string"==typeof r&&(r=[[t.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(18)(r,a);r.locals&&(t.exports=r.locals)},106:function(t,e,n){(t.exports=n(17)(!1)).push([t.i,".scr-card-container {\n  position: relative;\n  width: 100%;\n}\n.scr-card-container > canvas {\n  width: 100%;\n}\n.scr-card-text {\n  width: 100%;\n  height: 100%;\n  font-size: 16px;\n  -webkit-user-select: none;\n  -moz-user-focus: none;\n  -moz-user-select: none;\n  -webkit-box-pack: center;\n  -ms-flex-pack: center;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: -webkit-flex;\n  display: flex;\n  -webkit-box-align: center;\n  -ms-flex-align: center;\n  -webkit-align-items: center;\n  align-items: center;\n  -webkit-justify-content: center;\n  justify-content: center;\n  position: absolute;\n  margin: auto;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  z-index: 1;\n}\n",""])}}).default});