!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("IncrementalDOM"),require("IdomBase")):"function"==typeof define&&define.amd?define(["IncrementalDOM","IdomBase"],t):"object"==typeof exports?exports.ScratchCard=t(require("IncrementalDOM"),require("IdomBase")):e.ScratchCard=t(e.IncrementalDOM,e.IdomBase)}(window,function(e,t){return function(e){function t(t){for(var r,i,s=t[0],c=t[1],l=t[2],d=0,p=[];d<s.length;d++)i=s[d],a[i]&&p.push(a[i][0]),a[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(u&&u(t);p.length;)p.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},a={5:0},o=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="./";var s=window.webpackJsonp_name_=window.webpackJsonp_name_||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;return o.push([104,0]),n()}({0:function(t,n){t.exports=e},1:function(e,n){e.exports=t},104:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(2),o=n.n(a),i=n(3),s=n.n(i),c=n(4),l=n.n(c),u=n(5),d=n.n(u),p=n(6),h=n.n(p),f=(n(105),n(1)),v=n.n(f),m=Object.prototype.hasOwnProperty,y=["class","scr-card-text"],b=["class","scr-card-container"],g=function(e){function t(e,n){s()(this,t);var r=d()(this,(t.__proto__||o()(t)).call(this,e,n));return r.state={height:0},r.myCanvas=null,r}return h()(t,e),l()(t,[{key:"createCanvas",value:function(){var e=document.getElementById(this.props.cardId?this.props.cardId:"scr-card-canvas"),t=e.getBoundingClientRect().width,n=e.getBoundingClientRect().height;this.setState({height:n}),e.setAttribute("width",t+"px"),e.setAttribute("height",n+"px"),e.setAttribute("style","position:absolute;z-index:2;");var r=e.getContext("2d");if(/^#\w{6}$|^#\w{3}$/i.test(this.props.cardMask))return r.beginPath(),r.fillStyle=this.props.cardMask,r.rect(0,0,t,n),r.closePath(),r.fill(),e;var a=new Image;return a.crossOrigin="Anonymous",a.src=this.props.cardMask||"https://res.126.net/cross/img/component/scratch-card/mask-default.png",a.onload=function(){r.drawImage(a,0,0,a.width,a.height,0,0,e.width,e.height)},e}},{key:"scratchFn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};if(e.playState&&e.myCanvasObject){e.autoShowPercent||0===e.autoShowPercent||(e.autoShowPercent=70),e.timeOut||0===e.timeOut||(e.timeOut=3e3);var r="ontouchstart"in window,a=r?"touchstart":"mousedown",o=r?"touchmove":"mousemove",i=r?"touchend":"mouseup",s=e.myCanvasObject.getContext("2d"),c=null,l=!1,u=[],d=0,p=0;document.body.addEventListener("touchmove",function(e){e.cancelable&&(l?e.preventDefault():e.stopPropagation())},{passive:!1}),e.myCanvasObject.addEventListener(a,function(t){var a=window.event||t;e.myCanvasObject.style.cursor="move";var o=e.myCanvasObject.getBoundingClientRect().x,i=e.myCanvasObject.getBoundingClientRect().y;l=!0,d=r?a.targetTouches[0].clientX-o:a.clientX-o,p=r?a.targetTouches[0].clientY-i:a.clientY-i,u.push([d,p]),e.playState?h():n()}),e.myCanvasObject.addEventListener(o,function(t){if(e.playState){var n=window.event||t,a=e.myCanvasObject.getBoundingClientRect().x,o=e.myCanvasObject.getBoundingClientRect().y;l&&(d=r?n.targetTouches[0].clientX-a:n.clientX-a,p=r?n.targetTouches[0].clientY-o:n.clientY-o,u.push([d,p]),h())}else{var i=0,s=e.timeOut/100;c=setInterval(function(){e.playState&&i<s?window.clearInterval(c):!e.playState&&i<s?++i:i>s&&window.clearInterval(c)},100)}}),e.myCanvasObject.addEventListener(i,function(n){l=!1,u=[];for(var r=s.getImageData(0,0,e.myCanvasObject.width,e.myCanvasObject.height).data,a=r.length/4,o=0,i=3;i<r.length;i+=4)o+=r[i]?0:1;o/a*100>=e.autoShowPercent&&(s.clearRect(0,0,e.myCanvasObject.width,e.myCanvasObject.height),t())})}function h(){if(s.save(),s.beginPath(),s.moveTo(u[0][0],u[0][1]),s.lineCap="round",s.lineJoin="round",s.lineWidth=e.scratchWidth,s.globalCompositeOperation="destination-out",1===u.length)s.lineTo(u[0][0]+1,u[0][1]+1);else for(var t=1;t<u.length;t++)s.lineTo(u[t][0],u[t][1]),s.moveTo(u[t][0],u[t][1]);s.closePath(),s.stroke(),s.restore()}}},{key:"shouldUpdate",value:function(e){return this.scratchFn({myCanvasObject:this.myCanvas,scratchWidth:e.scratchWidth,playState:e.playState,autoShowPercent:e.autoShowPercent}),!0}},{key:"didMounted",value:function(){this.myCanvas=this.createCanvas(),this.scratchFn({myCanvasObject:this.myCanvas,scratchWidth:this.props.scratchWidth,playState:this.props.playState,autoShowPercent:this.props.autoShowPercent},this.props.sucCb,this.props.failCb)}},{key:"render",value:function(){var e=this;return Object(r.elementOpen)("div","uuid-22",b,"style","height: "+e.state.height+"px"),Object(r.elementOpen)("canvas",null,null,"id",this.props.cardId?this.props.cardId:"scr-card-canvas"),Object(r.elementClose)("canvas"),Object(r.elementOpen)("div","uuid-21",y,"style",this.props.prizeStyle),function e(t){var n=typeof t;if("number"===n||"string"===n||"object"===n&&t instanceof String)Object(r.text)(t);else if(Array.isArray(t))for(var a=0;a<t.length;a++)e(t[a]);else if("object"===n)if(t.__jsxDOMWrapper){var o=t.func,i=t.args;i?o.apply(this,i):o()}else if("[object Object]"===String(t))for(var s in t)m.call(t,a)&&e(t[a])}(this.props.prizeNames||""),Object(r.elementClose)("div"),Object(r.elementClose)("div")}}]),t}(v.a);t.default=g},105:function(e,t,n){var r=n(106);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(18)(r,a);r.locals&&(e.exports=r.locals)},106:function(e,t,n){(e.exports=n(17)(!1)).push([e.i,".scr-card-container {\n  position: relative;\n  width: 100%;\n}\n.scr-card-container > canvas {\n  width: 100%;\n}\n.scr-card-text {\n  width: 100%;\n  height: 100%;\n  font-size: 16px;\n  -webkit-user-select: none;\n  -moz-user-focus: none;\n  -moz-user-select: none;\n  -webkit-box-pack: center;\n  -ms-flex-pack: center;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: -webkit-flex;\n  display: flex;\n  -webkit-box-align: center;\n  -ms-flex-align: center;\n  -webkit-align-items: center;\n  align-items: center;\n  -webkit-justify-content: center;\n  justify-content: center;\n  position: absolute;\n  margin: auto;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  z-index: 1;\n}\n",""])}}).default});